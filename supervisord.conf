[supervisord]
nodaemon=true
logfile=/dev/stdout
loglevel=info

[program:ollama]
command=/bin/bash -lc "ollama serve"
priority=10
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr

[program:preload]
command=/bin/bash -lc "sleep 10; (ollama pull phi3:mini || true); echo phi3:mini preload done"
priority=20
autostart=true
autorestart=false
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr

[program:web]
command=/bin/bash -lc "cd /app && ./start.sh"
priority=30
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr