[build]
builder = "nixpacks" 
# Force redeploy: updated PostgreSQL password Yar1el_2025_Secure! - 2025-07-26

[deploy]
startCommand = "cd backend && python app.py"

[deploy.env]
# DATABASE_URL = "${{Postgres.DATABASE_URL}}"  # Commented out - using manual override
PGHOST = "${{Postgres.PGHOST}}"  
PGPORT = "${{Postgres.PGPORT}}"
PGUSER = "${{Postgres.PGUSER}}"
PGPASSWORD = "${{Postgres.PGPASSWORD}}"
PGDATABASE = "${{Postgres.PGDATABASE}}"
healthcheckPath = "/health"
healthcheckTimeout = 120
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 3

# Persistent volume for database storage
[volumes]
data = "/data"

[build.env]
NIXPACKS_PYTHON_VERSION = "3.11"
NIXPACKS_INSTALL_CMD = "pip install -r backend/requirements.txt"