[build]
builder = "nixpacks" 
# Force redeploy: use Railway internal PostgreSQL connection

[deploy]
startCommand = "cd backend && python app.py"

[deploy.env]
DATABASE_URL = "${{Postgres.DATABASE_URL}}"
PGHOST = "${{Postgres.PGHOST}}"  
PGPORT = "${{Postgres.PGPORT}}"
PGUSER = "${{Postgres.PGUSER}}"
PGPASSWORD = "${{Postgres.PGPASSWORD}}"
PGDATABASE = "${{Postgres.PGDATABASE}}"
healthcheckPath = "/health"
healthcheckTimeout = 120
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 3

# Persistent volume for database storage
[volumes]
data = "/data"

[build.env]
NIXPACKS_PYTHON_VERSION = "3.11"
NIXPACKS_INSTALL_CMD = "pip install -r backend/requirements.txt"