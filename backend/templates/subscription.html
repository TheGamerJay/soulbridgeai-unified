<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <meta name="cache-buster" content="{{ range(10000, 99999) | random }}">
  <title>SoulBridge AI - Soul Companions</title>
  <link rel="canonical" href="https://soulbridgeai.com/subscription" />
  <script src="https://js.stripe.com/v3/"></script>
  <style>
    .plan-container {
        min-height: 100vh;
        background: linear-gradient(135deg, #000000 0%, #0f172a 50%, #1e293b 100%);
        padding: 40px 20px;
    }

    .plan-header {
        text-align: center;
        margin-bottom: 50px;
        color: #e2e8f0;
    }

    .plan-title {
        font-size: 2.5rem;
        font-weight: bold;
        margin-bottom: 15px;
        background: linear-gradient(135deg, #22d3ee, #06b6d4);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .plan-grid {
        max-width: 1000px;
        margin: 0 auto;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 40px;
    }

    .plan-card {
        background: rgba(0,0,0,0.9);
        border: 2px solid #22d3ee;
        border-radius: 16px;
        padding: 40px 30px;
        text-align: center;
        transition: all 0.3s ease;
        position: relative;
        backdrop-filter: blur(15px);
        color: #ffffff;
    }

    .plan-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 20px 40px rgba(34, 211, 238, 0.3);
    }

    .plan-card.pro {
        border-color: #06b6d4;
        background: rgba(6, 182, 212, 0.05);
    }

    .plan-card.pro:hover {
        box-shadow: 0 20px 40px rgba(6, 182, 212, 0.3);
    }

    .badge {
        background: linear-gradient(135deg, #06b6d4, #0891b2);
        color: #000000;
        padding: 8px 20px;
        border-radius: 20px;
        font-size: 0.9rem;
        font-weight: bold;
        position: absolute;
        top: -15px;
        left: 50%;
        transform: translateX(-50%);
    }

    .plan-icon {
      font-size: 3rem;
      margin-bottom: 20px;
    }

    .plan-name {
      font-size: 1.8rem;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 16px;
    }

    .plan-price {
      font-size: 2.5rem;
      font-weight: 800;
      margin-bottom: 8px;
      color: #ffffff;
    }

    .plan-period {
      color: #94a3b8;
      margin-bottom: 30px;
      font-size: 1.1rem;
    }

    .plan-features {
        list-style: none;
        margin-bottom: 30px;
        text-align: left;
        padding: 0;
    }

    .plan-features li {
        margin-bottom: 12px;
        color: #ffffff;
        display: flex;
        align-items: center;
        padding: 8px 0;
        border-bottom: 1px solid rgba(34, 211, 238, 0.1);
    }

    .plan-features li:last-child {
      border-bottom: none;
    }

    .feature-icon {
      color: #10b981;
      margin-right: 12px;
      font-size: 1.1rem;
    }

    .select-btn {
      width: 100%;
      padding: 16px;
      border: none;
      border-radius: 12px;
      font-weight: 600;
      font-size: 1.1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      background: linear-gradient(135deg, #22d3ee, #0891b2);
      color: #000000;
    }

    .select-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(34, 211, 238, 0.4);
    }

    .select-btn.pro {
      background: linear-gradient(135deg, #06b6d4, #0891b2);
    }

    .back-btn {
        position: absolute;
        top: 20px;
        left: 20px;
        color: #22d3ee;
        text-decoration: none;
        font-size: 1.1rem;
        padding: 10px 20px;
        border: 1px solid #22d3ee;
        border-radius: 8px;
        transition: all 0.3s ease;
    }

    .back-btn:hover {
        background: rgba(34, 211, 238, 0.1);
    }

    .credits-info {
        background: rgba(15, 23, 42, 0.8);
        border: 1px solid #22d3ee;
        border-radius: 12px;
        padding: 20px;
        margin: 40px auto;
        max-width: 800px;
        text-align: center;
    }

    .credits-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-top: 20px;
    }

    .credit-item {
        background: rgba(0, 0, 0, 0.3);
        padding: 15px;
        border-radius: 8px;
        border: 1px solid rgba(34, 211, 238, 0.2);
    }

    .credit-cost {
        color: #22d3ee;
        font-weight: bold;
    }

    .pricing-toggle {
        display: flex;
        justify-content: center;
        margin: 30px auto;
        background: rgba(15, 23, 42, 0.8);
        border-radius: 50px;
        padding: 4px;
        width: fit-content;
    }

    .toggle-option {
        padding: 12px 30px;
        border-radius: 50px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: 600;
        color: #94a3b8;
    }

    .toggle-option.active {
        background: linear-gradient(135deg, #22d3ee, #0891b2);
        color: #000000;
    }
  </style>
</head>
<body>
  <!-- Back Button -->
  <a href="/intro" class="back-btn">← Back to Intro</a>

<div class="plan-container">
    <div class="plan-header">
        <h1 class="plan-title">Soul Companions</h1>
        <p style="font-size: 1.2rem; margin-bottom: 20px;">Choose your Artistic Time credits package</p>
        <div style="background: rgba(34, 211, 238, 0.1); border: 1px solid #22d3ee; border-radius: 8px; padding: 15px; margin: 20px auto; max-width: 600px; text-align: center;">
            <strong>🎭 All 31 Soul Companions Available</strong><br>
            <span style="color: #94a3b8;">Features powered by Artistic Time credits</span>
        </div>
    </div>

  <!-- Pricing Toggle -->
  <div class="pricing-toggle">
    <div class="toggle-option active" onclick="togglePricing('monthly', event)">Monthly</div>
    <div class="toggle-option" onclick="togglePricing('yearly', event)">Yearly (Save 25%)</div>
  </div>

  <!-- Plan Cards -->
  <div class="plan-grid">

    <!-- Soul Companions Free -->
    <div class="plan-card">
      <div class="plan-icon">🆓</div>
      <div class="plan-name">Soul Companions</div>
      <div class="plan-price">FREE</div>
      <div class="plan-period">One-time signup bonus</div>

      <ul class="plan-features">
        <li><span class="feature-icon">✨</span> <strong>100 Artistic Time credits</strong> on signup</li>
        <li><span class="feature-icon">🎭</span> Access to all 31 Soul Companions</li>
        <li><span class="feature-icon">💬</span> Chat with any companion (1 credit/message)</li>
        <li><span class="feature-icon">🔮</span> All features unlocked (credit-based)</li>
        <li><span class="feature-icon">🎯</span> Perfect for exploring the platform</li>
        <li><span class="feature-icon">📱</span> Full mobile experience</li>
      </ul>

      <button class="select-btn" onclick="selectPlan('soul_companion')">Get Started Free</button>
    </div>

    <!-- Soul Companions Pro -->
    <div class="plan-card pro">
      <div class="badge">Most Popular</div>
      <div class="plan-icon">💎</div>
      <div class="plan-name">Soul Companions Pro</div>
      <div class="plan-price" id="pro-price">$12.99</div>
      <div class="plan-period" id="pro-period">/month</div>

      <ul class="plan-features">
        <li><span class="feature-icon">⚡</span> <strong>300 Artistic Time credits</strong> monthly</li>
        <li><span class="feature-icon">🎭</span> Access to all 31 Soul Companions</li>
        <li><span class="feature-icon">💬</span> Extended conversations</li>
        <li><span class="feature-icon">🎨</span> AI image generation (15 credits each)</li>
        <li><span class="feature-icon">🎵</span> Mini Studio access (20+ credits)</li>
        <li><span class="feature-icon">📝</span> Voice journaling (10 credits)</li>
        <li><span class="feature-icon">🔮</span> All premium features unlocked</li>
        <li><span class="feature-icon">🛒</span> Can purchase additional credit top-ups</li>
      </ul>

      <button class="select-btn pro" onclick="selectPlan('soul_companion_pro')">Choose Pro</button>
    </div>

  </div>

  <!-- Credit Cost Information -->
  <div class="credits-info">
    <h3 style="color: #22d3ee; margin-bottom: 15px;">💫 Artistic Time Credit Costs</h3>
    <p style="color: #e2e8f0; margin-bottom: 20px;">All features are available to everyone - just powered by credits!</p>

    <div class="credits-grid">
      <div class="credit-item">
        <div>💬 Chat Message</div>
        <div class="credit-cost">1 credit</div>
      </div>
      <div class="credit-item">
        <div>🔍 Decoder</div>
        <div class="credit-cost">3 credits</div>
      </div>
      <div class="credit-item">
        <div>⭐ Horoscope</div>
        <div class="credit-cost">3 credits</div>
      </div>
      <div class="credit-item">
        <div>🔮 Fortune</div>
        <div class="credit-cost">5 credits</div>
      </div>
      <div class="credit-item">
        <div>🧩 Soul Riddle</div>
        <div class="credit-cost">4 credits</div>
      </div>
      <div class="credit-item">
        <div>✍️ Creative Writer</div>
        <div class="credit-cost">8 credits</div>
      </div>
      <div class="credit-item">
        <div>🎨 AI Images</div>
        <div class="credit-cost">15 credits</div>
      </div>
      <div class="credit-item">
        <div>🎵 Mini Studio</div>
        <div class="credit-cost">20+ credits</div>
      </div>
    </div>
  </div>

  <!-- Additional Top-up Options for Pro Users -->
  <div class="credits-info" style="margin-top: 60px;">
    <h3 style="color: #06b6d4; margin-bottom: 15px;">💳 Need More Credits? (Pro Users Only)</h3>
    <p style="color: #94a3b8; margin-bottom: 20px;">Running low on your monthly credits? Purchase instant top-ups!</p>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; max-width: 600px; margin: 0 auto;">
      <div style="background: rgba(0, 0, 0, 0.5); padding: 20px; border-radius: 12px; border: 1px solid #06b6d4;">
        <div style="font-size: 1.5rem; margin-bottom: 10px;">💫</div>
        <div style="color: #ffffff; font-weight: bold;">Small Pack</div>
        <div style="color: #06b6d4; font-size: 1.2rem; font-weight: bold;">50 credits</div>
        <div style="color: #94a3b8;">$2.99</div>
      </div>
      <div style="background: rgba(0, 0, 0, 0.5); padding: 20px; border-radius: 12px; border: 1px solid #06b6d4;">
        <div style="font-size: 1.5rem; margin-bottom: 10px;">⭐</div>
        <div style="color: #ffffff; font-weight: bold;">Medium Pack</div>
        <div style="color: #06b6d4; font-size: 1.2rem; font-weight: bold;">120 credits</div>
        <div style="color: #94a3b8;">$5.99</div>
      </div>
      <div style="background: rgba(0, 0, 0, 0.5); padding: 20px; border-radius: 12px; border: 1px solid #06b6d4;">
        <div style="font-size: 1.5rem; margin-bottom: 10px;">💎</div>
        <div style="color: #ffffff; font-weight: bold;">Large Pack</div>
        <div style="color: #06b6d4; font-size: 1.2rem; font-weight: bold;">300 credits</div>
        <div style="color: #94a3b8;">$12.99</div>
      </div>
    </div>
  </div>

</div>

<script>
// Stripe integration
const stripeKey = '{{ stripe_public_key if stripe_public_key else "" }}';
const stripe = stripeKey ? Stripe(stripeKey) : null;

// Pricing plans with Stripe price IDs
const plans = {
  monthly: {
    soul_companion_pro: {
      priceId: '{{ stripe_price_monthly }}',
      price: '$12.99',
      period: '/month'
    }
  },
  yearly: {
    soul_companion_pro: {
      priceId: '{{ stripe_price_yearly }}',
      price: '$117.00',
      period: '/year',
      savings: 'Save $39'
    }
  }
};

let currentBilling = 'monthly';

function togglePricing(type, event) {
  // Update toggle UI
  document.querySelectorAll('.toggle-option').forEach(option => option.classList.remove('active'));
  event.target.classList.add('active');

  currentBilling = type;

  // Update Pro pricing
  const proData = plans[type].soul_companion_pro;
  document.getElementById('pro-price').innerHTML = proData.price + (proData.savings ? ' <span style="color: #10b981; font-size: 0.8em;">' + proData.savings + '</span>' : '');
  document.getElementById('pro-period').textContent = proData.period;
}

function selectPlan(planType) {
  if (planType === 'soul_companion') {
    // Free tier - redirect to signup
    window.location.href = '/register';
    return;
  }

  if (planType === 'soul_companion_pro') {
    // Pro tier - create Stripe checkout
    if (!stripe) {
      alert('Payment system is not configured. Please contact support.');
      return;
    }

    const planData = plans[currentBilling].soul_companion_pro;

    stripe.redirectToCheckout({
      lineItems: [{
        price: planData.priceId,
        quantity: 1,
      }],
      mode: 'subscription',
      successUrl: window.location.origin + '/success?plan=' + planType,
      cancelUrl: window.location.origin + '/subscription',
      clientReferenceId: '{{ user_id if user_id else "" }}',
    }).then(function (result) {
      if (result.error) {
        console.error('Stripe error:', result.error.message);
        alert('Payment failed: ' + result.error.message);
      }
    });
  }
}

// Initialize page
document.addEventListener('DOMContentLoaded', function() {
  console.log('🎭 Soul Companions subscription page loaded');
});
</script>

</body>
</html>