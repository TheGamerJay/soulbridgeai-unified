<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat with {{ selected_companion or 'AI Assistant' }} - SoulBridge AI</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <meta name="theme-color" content="#00ffff">
    
    <!-- Open Graph / Social Media Meta Tags -->
    <meta property="og:title" content="SoulBridge AI - Chat with {{ selected_companion or 'AI Assistant' }}">
    <meta property="og:description" content="Your AI companion for emotional wellness and spiritual growth">
    <meta property="og:image" content="{{ url_for('static', filename='logos/IntroLogo.png', _external=True) }}">
    <meta property="og:url" content="{{ request.url }}">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="SoulBridge AI">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="SoulBridge AI">
    <meta name="twitter:description" content="Your AI companion for emotional wellness and spiritual growth">
    <meta name="twitter:image" content="{{ url_for('static', filename='logos/IntroLogo.png', _external=True) }}">
    
    <!-- CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}?v={{ range(1000000) | random }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/chat.css') }}?v={{ range(1000000) | random }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="chat-container">
        <!-- Header -->
        <div class="chat-header">
            <div class="character-info">
                <img src="/static/logos/IntroLogo.png" alt="AI Companion" class="character-avatar">
                <div class="character-details">
                    <h2 data-character="{{ selected_companion or 'AI Assistant' }}">{{ selected_companion or 'AI Assistant' }}</h2>
                    <div class="character-status">
                        <span class="status-indicator"></span>
                        Online and ready to chat
                    </div>
                </div>
            </div>
            
            <div class="header-actions">
                <a href="/companion-selection" class="action-btn">
                    <i class="fas fa-exchange-alt"></i>
                    Switch
                </a>
                <button id="voiceChatBtn" class="action-btn voice-chat" style="display: none;" onclick="toggleVoiceChat()">
                    <i class="fas fa-microphone"></i>
                    Voice
                </button>
                <a href="/decoder" class="action-btn">
                    <i class="fas fa-brain"></i>
                    Decoder
                </a>
                <a href="/library" class="action-btn">
                    <i class="fas fa-book"></i>
                    Library
                </a>
                
                <!-- Max Tier Addon Buttons -->
                {% if session.get('user_plan') == 'enterprise' %}
                <a href="/voice-journaling" class="action-btn addon-btn" title="Voice Journaling - Max Tier Feature">
                    <i class="fas fa-microphone-alt"></i>
                    Journal
                </a>
                <a href="/relationship-profiles" class="action-btn addon-btn" title="Relationship Tools - Max Tier Feature">
                    <i class="fas fa-heart"></i>
                    Relations
                </a>
                <a href="/emotional-meditations" class="action-btn addon-btn" title="Emotional Meditations - Max Tier Feature">
                    <i class="fas fa-om"></i>
                    Meditate
                </a>
                <a href="/ai-image-generation" class="action-btn addon-btn" title="AI Image Generation - Max Tier Feature">
                    <i class="fas fa-image"></i>
                    Images
                </a>
                {% endif %}
                
                <button onclick="saveConversationToLibrary()" class="action-btn" title="Save current conversation to library">
                    <i class="fas fa-save"></i>
                    Save
                </button>
                <button onclick="clearChat()" class="action-btn">
                    <i class="fas fa-trash"></i>
                    Clear
                </button>
            </div>
        </div>
        
        <!-- Floating Home Button - Top Right Corner -->
        <a href="/intro" class="floating-home-btn" title="Go to Home">
            <i class="fas fa-home"></i>
        </a>
        
        <!-- Messages Area -->
        <div class="chat-messages" id="chatMessages">
            <!-- Messages will be added here by JavaScript -->
        </div>
        
        <!-- Input Area -->
        <div class="chat-input-area">
            <div class="input-container">
                <textarea 
                    id="messageInput" 
                    class="message-input" 
                    placeholder="Type your message here..." 
                    rows="1"
                ></textarea>
                <button class="send-button" disabled>
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="{{ url_for('static', filename='js/chat.js') }}?v={{ range(1000000) | random }}"></script>
</body>
</html>